(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac1b3722"],{"3a2e":function(e,t,o){},"468c":function(e,t,o){"use strict";o.r(t);o("b0c0");var c=o("7a23"),n=Object(c["createTextVNode"])("　　保存　　"),a=Object(c["createTextVNode"])("保存并关闭"),l=Object(c["createTextVNode"])("　　关闭　　"),i=Object(c["createTextVNode"])(" 使用模板 "),r=Object(c["createTextVNode"])(" 使用文档 "),d=Object(c["createTextVNode"])(" 引用文档 "),s=Object(c["createTextVNode"])(" 插入文件 "),u=Object(c["createTextVNode"])(" 插入视频 "),h={key:0},p={style:{height:"360px"}},b=["onClick"],f={class:"dialog-footer"},m=Object(c["createTextVNode"])("关闭"),O={style:{height:"360px"}},j=["onClick"],g={class:"dialog-footer"},w=Object(c["createTextVNode"])("关闭"),x={class:"dialog-footer"},k=Object(c["createTextVNode"])("完 成");function C(e,t,o,C,V,v){var N=this,y=Object(c["resolveComponent"])("el-col"),D=Object(c["resolveComponent"])("el-input"),I=Object(c["resolveComponent"])("el-button"),_=Object(c["resolveComponent"])("el-button-group"),T=Object(c["resolveComponent"])("el-row"),B=Object(c["resolveComponent"])("Notebook"),U=Object(c["resolveComponent"])("el-icon"),S=Object(c["resolveComponent"])("Document"),E=Object(c["resolveComponent"])("Link"),L=Object(c["resolveComponent"])("FolderOpened"),$=Object(c["resolveComponent"])("VideoPlay"),P=Object(c["resolveComponent"])("el-tag"),F=Object(c["resolveComponent"])("el-header"),z=Object(c["resolveComponent"])("v-md-editor"),J=Object(c["resolveComponent"])("el-main"),H=Object(c["resolveComponent"])("el-option"),M=Object(c["resolveComponent"])("el-select"),A=Object(c["resolveComponent"])("Search"),K=Object(c["resolveComponent"])("el-collapse-item"),R=Object(c["resolveComponent"])("el-collapse"),q=Object(c["resolveComponent"])("el-container"),G=Object(c["resolveComponent"])("el-affix"),Q=Object(c["resolveComponent"])("el-dialog"),W=Object(c["resolveComponent"])("doc-file-upload");return Object(c["openBlock"])(),Object(c["createBlock"])(q,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(F,{style:{height:"70px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(T,{style:{"line-height":"40px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(y,{span:8,style:{"text-align":"right","padding-right":"20px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(N.collected.name+"："+N.parentDocPath),1)]})),_:1}),Object(c["createVNode"])(y,{span:8},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(D,{modelValue:V.title,"onUpdate:modelValue":t[0]||(t[0]=function(e){return V.title=e}),placeholder:"请输入文档标题"},null,8,["modelValue"])]})),_:1}),Object(c["createVNode"])(y,{span:2}),Object(c["createVNode"])(y,{span:6,style:{"text-align":"right"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(_,null,{default:Object(c["withCtx"])((function(){return[N.docId?(Object(c["openBlock"])(),Object(c["createBlock"])(I,{key:0,type:"success",onClick:v.save,round:""},{default:Object(c["withCtx"])((function(){return[n]})),_:1},8,["onClick"])):Object(c["createCommentVNode"])("",!0),N.operationStatus?(Object(c["openBlock"])(),Object(c["createBlock"])(I,{key:1,type:"primary",onClick:v.saveAndClose,round:""},{default:Object(c["withCtx"])((function(){return[a]})),_:1},8,["onClick"])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(I,{type:"danger",onClick:v.close,round:""},{default:Object(c["withCtx"])((function(){return[l]})),_:1},8,["onClick"])]})),_:1})]})),_:1})]})),_:1}),Object(c["createVNode"])(T,{style:{padding:"5px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(y,{span:12},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(_,{style:{"padding-left":"5px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{size:"small",onClick:t[1]||(t[1]=function(e){return v.openTempletDialog()})},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,{style:{"padding-right":"3px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(B)]})),_:1}),i]})),_:1})]})),_:1}),Object(c["createVNode"])(_,{style:{"padding-left":"5px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{size:"small"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,{style:{"padding-right":"3px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(S)]})),_:1}),r]})),_:1})]})),_:1}),Object(c["createVNode"])(_,{style:{"padding-left":"5px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{size:"small",onClick:t[2]||(t[2]=function(e){return v.openIlinkDialog()})},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,{style:{"padding-right":"3px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(E)]})),_:1}),d]})),_:1})]})),_:1}),Object(c["createVNode"])(_,{style:{"padding-left":"5px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{size:"small",onClick:t[3]||(t[3]=function(e){return v.openUploadFileDialog("")})},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,{style:{"padding-right":"3px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(L)]})),_:1}),s]})),_:1})]})),_:1}),Object(c["createVNode"])(_,{style:{"padding-left":"5px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{size:"small",onClick:t[4]||(t[4]=function(e){return v.openUploadFileDialog("video")})},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,{style:{"padding-right":"3px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])($)]})),_:1}),u]})),_:1})]})),_:1})]})),_:1}),Object(c["createVNode"])(y,{span:12,style:{"text-align":"right"}}),Object(c["createVNode"])(y,{span:6,style:{"text-align":"right"}},{default:Object(c["withCtx"])((function(){return[N.lockUser&&N.lockUser.realName?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",h,[Object(c["createVNode"])(P,{class:"ml-2",type:"warning",size:"small",effect:"plain"},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])("当前由："+Object(c["toDisplayString"])(N.lockUser.realName)+" 编辑锁定",1)]})),_:1})])):Object(c["createCommentVNode"])("",!0)]})),_:1})]})),_:1})]})),_:1}),Object(c["createVNode"])(J,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(z,{ref:"editor",modelValue:V.content,"onUpdate:modelValue":t[5]||(t[5]=function(e){return V.content=e}),height:"100%","include-level":[1,2,3,4],"disabled-menus":[],"left-toolbar":"undo redo clear | h bold italic strikethrough quote | ul ol table hr | link image code | ilink","before-preview-change":v.beforePreviewChange,onUploadImage:v.handleUploadImage,onChange:v.textChange,toolbar:e.toolbar},null,8,["modelValue","before-preview-change","onUploadImage","onChange","toolbar"])]})),_:1}),Object(c["createVNode"])(Q,{modelValue:V.ilinkDialog.show,"onUpdate:modelValue":t[10]||(t[10]=function(e){return V.ilinkDialog.show=e}),title:"引用文档",width:"50%",center:""},{footer:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("span",f,[Object(c["createVNode"])(G,{position:"bottom",offset:20},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{type:"primary",size:"mini",onClick:t[9]||(t[9]=function(e){return V.ilinkDialog.show=!1}),style:{width:"200px"}},{default:Object(c["withCtx"])((function(){return[m]})),_:1})]})),_:1})])]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(q,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(F,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(D,{modelValue:N.ilinkDialog.searchText,"onUpdate:modelValue":t[8]||(t[8]=function(e){return N.ilinkDialog.searchText=e}),placeholder:"搜索一下",class:"input-with-select",onKeydown:v.searchIlinkEnter,clearable:""},{prepend:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(M,{modelValue:N.ilinkDialog.searchMode,"onUpdate:modelValue":t[6]||(t[6]=function(e){return N.ilinkDialog.searchMode=e}),placeholder:"Select",style:{width:"110px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(H,{label:"全文",value:"1"}),Object(c["createVNode"])(H,{label:"关键字",value:"2"})]})),_:1},8,["modelValue"])]})),append:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{onClick:t[7]||(t[7]=function(e){return v.searchIlink()})},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(A)]})),_:1})]})),_:1})]})),_:1},8,["modelValue","onKeydown"])]})),_:1}),Object(c["createVNode"])(J,{style:{"margin-left":"30px","margin-right":"30px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("div",p,[Object(c["createVNode"])(R,{accordion:""},{default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(N.ilinkDialog.collectedList,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(K,{key:e,title:e.name,name:e.id},{default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.docLites,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:t,style:{"border-bottom":"1px dashed #ccc",padding:"2px"}},[Object(c["createElementVNode"])("div",{class:"import-item",style:{cursor:"pointer"},onClick:function(o){return v.addIlinkDoc(t.title,e.id,t.id)}},[Object(c["createElementVNode"])("span",null,"　"+Object(c["toDisplayString"])(t.title)+"　",1)],8,b)])})),128))]})),_:2},1032,["title","name"])})),128))]})),_:1})])]})),_:1})]})),_:1})]})),_:1},8,["modelValue"]),Object(c["createVNode"])(Q,{modelValue:V.templetDialog.show,"onUpdate:modelValue":t[15]||(t[15]=function(e){return V.templetDialog.show=e}),title:"模板文档",width:"50%",center:""},{footer:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("span",g,[Object(c["createVNode"])(G,{position:"bottom",offset:20},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{type:"primary",size:"mini",onClick:t[14]||(t[14]=function(e){return V.templetDialog.show=!1}),style:{width:"200px"}},{default:Object(c["withCtx"])((function(){return[w]})),_:1})]})),_:1})])]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(q,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(F,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(D,{modelValue:N.templetDialog.searchText,"onUpdate:modelValue":t[13]||(t[13]=function(e){return N.templetDialog.searchText=e}),placeholder:"搜索一下",class:"input-with-select",onKeydown:v.searchTempletEnter,clearable:""},{prepend:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(M,{modelValue:N.templetDialog.searchMode,"onUpdate:modelValue":t[11]||(t[11]=function(e){return N.templetDialog.searchMode=e}),placeholder:"Select",style:{width:"110px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(H,{label:"全文",value:"1"}),Object(c["createVNode"])(H,{label:"关键字",value:"2"})]})),_:1},8,["modelValue"])]})),append:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{onClick:t[12]||(t[12]=function(e){return v.searchTemplet()})},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(A)]})),_:1})]})),_:1})]})),_:1},8,["modelValue","onKeydown"])]})),_:1}),Object(c["createVNode"])(J,{style:{"margin-left":"30px","margin-right":"30px"}},{default:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("div",O,[Object(c["createVNode"])(R,{accordion:""},{default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(N.templetDialog.collectedList,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])(K,{key:e,title:e.name,name:e.id},{default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.docLites,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:t,style:{"border-bottom":"1px dashed #ccc",padding:"2px"}},[Object(c["createElementVNode"])("div",{class:"import-item",style:{cursor:"pointer"},onClick:function(o){return v.addTempletDoc(t.title,e.id,t.id)}},[Object(c["createElementVNode"])("span",null,"　"+Object(c["toDisplayString"])(t.title)+"　",1)],8,j)])})),128))]})),_:2},1032,["title","name"])})),128))]})),_:1})])]})),_:1})]})),_:1})]})),_:1},8,["modelValue"]),Object(c["createVNode"])(Q,{title:e.上传文件,modelValue:V.uploadSet.dialogVisible,"onUpdate:modelValue":t[17]||(t[17]=function(e){return V.uploadSet.dialogVisible=e})},{footer:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("span",x,[Object(c["createVNode"])(I,{type:"primary",onClick:t[16]||(t[16]=function(e){return V.uploadSet.dialogVisible=!1})},{default:Object(c["withCtx"])((function(){return[k]})),_:1})])]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(W,{uploadDataParams:V.uploadSet.uploadDataParams,callback:v.uploadCallback,ref:"docFileUpload"},null,8,["uploadDataParams","callback"])]})),_:1},8,["title","modelValue"])]})),_:1})}o("99af");var V=o("3ef4"),v=o("c9a1"),N=Object(c["createTextVNode"])("点击上传"),y={class:"el-upload__tip"};function D(e,t,o,n,a,l){var i=Object(c["resolveComponent"])("el-button"),r=Object(c["resolveComponent"])("el-upload");return Object(c["openBlock"])(),Object(c["createBlock"])(r,{class:"upload-demo",action:a.fileUploadUrl,headers:a.headers,data:a.data,"on-success":l.handlerSuccess,"on-preview":l.handlePreview,"on-remove":l.handleRemove,"before-upload":l.beforeUpload,"before-remove":e.beforeRemove,multiple:"",limit:10,"on-exceed":l.handleExceed,"file-list":a.fileList,accept:a.accept},{tip:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("div",y,"上传 "+Object(c["toDisplayString"])(a.fileTypeDesc)+" 文件（服务器磁盘空间有限，请注意个人账户的空间用量）",1)]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(i,{size:"small",type:"primary"},{default:Object(c["withCtx"])((function(){return[N]})),_:1})]})),_:1},8,["action","headers","data","on-success","on-preview","on-remove","before-upload","before-remove","on-exceed","file-list","accept"])}var I=o("b775"),_=o("5f87"),T=o("01ea"),B={props:{uploadDataParams:Object,callback:{type:Function}},data:function(){return{fileUploadUrl:"",headers:[],data:{},fileList:[],fileType:"",fileTypeDesc:"",accept:"*",whiteList:[]}},mounted:function(){console.log("mount begin"),this.fileUploadUrl=Object(T["a"])().baseServer+"f/u",this.headers["Access-Token"]=Object(_["e"])(),this.data=this.uploadDataParams,console.log(this.data);var e=this.$store.state.user.token;console.log("token-1-1-1: "+e);var t=this.$store.state.user.name;console.log("name: "+t),console.log("mount end")},components:{},methods:{openPanel:function(){switch(console.log("openPanel"),this.fileList=[],this.fileType=this.data.fileType,this.fileType){case"image":this.fileTypeDesc="图片",this.accept="image/*",this.whiteList=["jpg","jpeg","png"];break;case"video":this.fileTypeDesc="视频",this.accept="video/*",this.whiteList=["mp4"];break;default:this.fileTypeDesc="其他",this.accept="*",this.whiteList=[];break}},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log("handlePreview"),console.log(this.bucket),console.log(this.bucket.id),console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 10 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeUpload:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1);if(this.whiteList.length>0&&-1===this.whiteList.indexOf(t))return this.$message.error("上传文件格式不符合要求"),!1;var o=e.size/1024/1024<1024;return o?void 0:(this.$message.error("上传文件大小不能超过 1 GB"),!1)},handlerSuccess:function(e,t,o){this.callback(e.data)}}},U=(o("fc90"),o("6b0d")),S=o.n(U);const E=S()(B,[["render",D]]);var L=E,$=o("05db");o("e9c4");function P(e,t,o){localStorage.setItem("ui-msg",JSON.stringify({page:e,element:t,id:o,date:Date.now()}))}o("2ef0");var F={name:"editor",data:function(){return this.toolbar={ilink:{title:"mermaid示例",icon:"v-md-icon-tip",action:function(e){e.insert((function(e){var t="```mermaid\n",o="```",c="sequenceDiagram\n    participant Alice\n    participant Bob\n    Alice->>John: Hello John, how are you?\n    loop Healthcheck\n        John->>John: Fight against hypochondria\n    end\n    Note right of John: Rational thoughts <br/>prevail!\n    John--\x3e>Alice: Great!\n    John->>Bob: How about you?\n    Bob--\x3e>John: Jolly good!\n",n=e||c;return{text:"".concat(t).concat(n).concat(o),selected:n}}))}}},{heartbeatTimer:"",ilinkDialog:{show:!1,collectedList:[],searchMode:"",searchText:""},templetDialog:{show:!1,collectedList:[],searchMode:"",searchText:""},dynamicTags:["标签一","标签二","标签三"],inputVisible:!1,inputValue:"",collected:{},activeName:"public",content:"",contentHtml:"",title:"",docId:"",parentDocId:"",parentDocPath:"",mode:"",operationStatus:!0,loadStatus:"create",createMode:"",uploadSet:{dialogVisible:!1,uploadDataParams:{bucketName:".hidoc"}},lockUser:{}}},mounted:function(){var e=this;document.title="Hidoc-文档编辑器",this.loadStatus="mounted",this.$refs.editor.toggleToc(),window.isCloseHint=!0,window.addEventListener("beforeunload",(function(e){if(window.isCloseHint){var t="您所作的更改可能未保存，确认离开吗？";return(e||window.event).returnValue=t,t}})),console.log("编辑器 config: "+Object(T["a"])());var t=this.$store.state.user.token;console.log("token: "+t),console.log("route params, docId:"+this.$route.params.docId),console.log("route params, collectedId:"+this.$route.params.collectedId),console.log("route params, parentDocId:"+this.$route.params.parentDocId),console.log("route params, copyDocId:"+this.$route.params.copyDocId);var o=this.$route.params.docId,c=this.$route.params.collectedId;this.parentDocId=this.$route.params.parentDocId,this.copyDocId=this.$route.params.copyDocId,"_blank"==this.parentDocId&&(this.parentDocId=""),console.log("this.parentDocId:"+this.parentDocId),console.log("collectedId:"+c+" docId:"+o),""!=this.parentDocId&&Object(I["a"])({url:"/doc/getPath",method:"post",data:{parentDocId:this.parentDocId}}).then((function(t){0==t.code&&t.meta.path&&(console.log("层级路径为："+t.meta.path),e.parentDocPath=t.meta.path)})),Object(I["a"])({url:"/collected/get",method:"post",data:{id:this.$route.params.collectedId}}).then((function(t){switch(e.loadStatus="active",e.collected=t.meta.collected,e.uploadSet.uploadDataParams.collectedId=e.collected.id,o){case"_create":e.mode="create";break;default:Object(I["a"])({url:"/doc/getForEdit",method:"post",data:{id:o}}).then((function(t){if(0==t.code&&t.meta.doc)switch(e.content=t.meta.doc.content,e.title=t.meta.doc.title,e.docId=t.meta.doc.id,t.status){case"ok":if(t.meta.doc.isCurrentUserLock)console.log("当前用户获取锁，准许编辑"),document.title=e.title,e.heartbeatTimer=setInterval(e.heartbeat,6e4);else{console.log("文档已被其他成员锁定，不能编辑");var o="文档已被其他成员锁定，不能编辑，您可以联系："+t.meta.user.realName+" "+t.meta.user.email+" ，解除锁定。";e.$alert(o,{confirmButtonText:"关闭",callback:function(e){window.close()}})}break;case"lock":if(t.meta.doc.isCurrentUserLock)console.log("当前用户获取锁，准许编辑"),document.title=e.title,e.heartbeatTimer=setInterval(e.heartbeat,6e4);else{console.log("文档已被其他成员锁定，不能编辑"),e.lockUser=t.meta.user;var c="文档已被其他成员锁定，不能编辑，您可以联系："+t.meta.user.realName+" "+t.meta.user.email+" ，解除锁定。";e.$alert(c,{confirmButtonText:"关闭",callback:function(e){window.close()}})}break;case"unauth":e.operationStatus=!1,e.$alert("没有操作权限",{confirmButtonText:"关闭",callback:function(e){window.close()}});break}}));break}})),"_none"!=this.copyDocId&&Object(I["a"])({url:"/doc/get",method:"post",data:{id:this.copyDocId}}).then((function(t){0==t.code&&(e.content=t.meta.doc.content)}))},components:{DocFileUpload:L},methods:{heartbeat:function(){return Object(I["a"])({url:"/openapi/heartbeat/lockDoc",method:"post",data:{id:this.docId}}).then((function(e){0==e.code&&console.log(e)}))},handleUploadImage:function(e,t,o){console.log(o);for(var c=new FormData,n=0;n<o.length;n++)c.append("file",o[n],o[n].name);return c.append("collectedId",this.collected.id),c.append("docId",this.docId),c.append("bucketName",".hidoc"),Object(I["a"])({url:"/f/u",method:"post",data:c}).then((function(e){0==e.code&&t({url:Object(T["a"])().hdImageFlag+e.data[0].uname,desc:"图片"})}))},uploadCallback:function(e){var t=this;if(e)for(var o=function(o){var c=e[o].fileName,n=e[o].uname,a=e[o].id,l=c.substring(c.lastIndexOf(".")+1);switch(l){case"mp4":t.$refs.editor.insert((function(e){var t='<video width="600" controls="controls" src="#hd.uname://',o='"></video>',c=e||n;return{text:"".concat(t).concat(c).concat(o)}}));break;case"doc":case"docx":case"xls":case"xlsx":case"ppt":case"pptx":case"pdf":case"txt":case"zip":case"rar":case"7z":default:t.$refs.editor.insert((function(e){var t='<div data-hd-file="'.concat(a,'">'),o="</div>",n=e||c;return{text:"".concat(t).concat(n).concat(o)}}));break}},c=0;c<e.length;c++)o(c)},openUploadFileDialog:function(e){this.uploadSet.dialogVisible=!0,this.uploadSet.uploadDataParams.fileType=e,this.$refs["docFileUpload"].openPanel()},beforePreviewChange:function(e,t){"active"==this.loadStatus?t(Object($["a"])(e)):t(e)},textChange:function(e,t){console.log(this.loadStatus),"active"==this.loadStatus&&(this.$refs.editor,this.$refs.editor.codemirrorInstance)},save:function(){var e=this;return Object(I["a"])({url:"/doc/save",method:"post",data:{collectedId:this.collected.id,title:this.title,content:this.content,tag:"tag",mode:this.mode,id:this.docId,parentDocId:this.parentDocId,unlock:!1}}).then((function(t){0==t.code&&(Object(V["a"])({message:"保存成功",type:"success",duration:5e3}),P("editor","doc",e.docId))}))},saveAndClose:function(){var e=this;return Object(I["a"])({url:"/doc/save",method:"post",data:{collectedId:this.collected.id,title:this.title,content:this.content,tag:"tag",mode:this.mode,id:this.docId,parentDocId:this.parentDocId,unlock:!0}}).then((function(t){0==t.code&&(P("editor","doc",e.docId),window.isCloseHint=!1,window.close())}))},close:function(){var e=this;v["a"].confirm("关闭会丢失您修改的内容，确认继续吗？","注意",{confirmButtonText:"强制关闭页面",cancelButtonText:"继续编辑",type:"warning"}).then((function(){if("create"!=e.mode)return Object(I["a"])({url:"/doc/unlock",method:"post",data:{id:e.docId}}).then((function(e){0==e.code?(window.isCloseHint=!1,window.close()):Object(V["a"])({message:e.msg||"Error",type:"error",duration:5e3})}));console.log("创建时关闭，无需解锁"),window.isCloseHint=!1,window.close()})).catch((function(){console.log("继续编辑")}))},openIlinkDialog:function(){this.ilinkDialog.show=!0,this.searchIlink()},searchIlinkEnter:function(e){13==e.keyCode&&this.searchIlink()},searchIlink:function(){var e=this;Object(I["a"])({url:"/collected/preview",method:"post",data:{mode:this.ilinkDialog.searchMode,keyword:this.ilinkDialog.searchText,from:"editor"}}).then((function(t){0==t.code&&(e.ilinkDialog.collectedList=t.data)}))},addIlinkDoc:function(e,t,o){this.$refs.editor.insert((function(c){var n="[",a="]("+Object(T["a"])().hdIlinkFlag+t+"/"+o+")",l=c||e;return{text:"".concat(n).concat(l).concat(a),selected:l}})),this.ilinkDialog.show=!1},openTempletDialog:function(){this.templetDialog.show=!0,this.searchTemplet()},searchTempletEnter:function(e){13==e.keyCode&&this.searchTemplet()},searchTemplet:function(){var e=this;Object(I["a"])({url:"/collected/preview",method:"post",data:{mode:this.templetDialog.searchMode,keyword:this.templetDialog.searchText,from:"editor",isTemplet:!0}}).then((function(t){0==t.code&&(e.templetDialog.collectedList=t.data)}))},addTempletDoc:function(e,t,o){var c=this;Object(I["a"])({url:"/doc/get",method:"post",data:{id:o}}).then((function(e){0==e.code&&(c.doc=e.meta.doc,c.content=c.doc.content,c.templetDialog.show=!1)}))},formatContent:function(e){}}};o("e5d4");const z=S()(F,[["render",C]]);t["default"]=z},e5d4:function(e,t,o){"use strict";o("3a2e")},ea27:function(e,t,o){},fc90:function(e,t,o){"use strict";o("ea27")}}]);
//# sourceMappingURL=chunk-ac1b3722.fe2b8258.js.map